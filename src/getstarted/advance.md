---
title: 进阶操作
icon: rocket
order: 2
---

# 进阶操作

帮助您了解SRA的更多高级功能，帮助您更好地使用SRA。

## 多账号托管

:::warning
多账号托管是 `0.8.0` 版本新增的功能，标签页名称为 `多账号`。

在更新版本中， `多账号`标签页名称变为 `配置方案`。

在2.0.0版本中，`配置方案`标签页被操作面板替代。
:::

在 `0.8.0` 及以上版本，SRA添加了多账号托管相关的配置功能。

可以点击标签页上方的 `多账号` (0.8.0版本)或 `配置方案` (更新版本)进入。

![0.8.0 版本中的"多账号(配置方案)"](/img/use/ma.png)

在`2.0.0`版本之后，该页面被简化的操作面板所替代。下面的内容以 `2.0.0` 版本之后的操作面板为例进行说明。

![操作面板](/img/use/operation2.png)

### 新建方案

点击操作面板左侧的 + 按钮，即可出现方案名称输入框。
![新建方案](/img/use/newplan.png)
输入方案名称后，点击右侧确认按钮，即可向配置方案列表中添加一个新方案。
如果方案名称为空，则会关闭输入框而不执行任何操作。

:::tip
每个 `配置方案` 对应着一个账号的托管方案，假设将要配置A、B、C三个账号托管

### 对于账号A

使用默认方案Default，到标签页 `任务` 中完成任务配置，在使用多账号托管时:

这些任务**必须配置**：

- 点击 `启动游戏` -选择 `游戏路径`
- 点击 `启动游戏` -勾选 `自动登录` (同时填充账号与密码)
- 点击 `结束后` -勾选 `退出当前账号`

这些任务**不能配置**：

- 模拟宇宙
- 退出游戏
- 退出SRA
- 关机
- 休眠

完成 `任务配置` 后，这些行为会触发当前 `配置方案` 的保存：

- 切换方案
- 执行任务
- 关闭窗口

### 对于账号B

点击操作面板左侧的 + 按钮，输入一个方案名称，例如'planB'，后点击确认按钮

点击右侧的配置方案选框就可以看到我们新建的planB，选中它，接下来像配置方案default那样配置planB即可。

### 对于账号C

同理。

现在我们有了三份方案，分别为default、planB、planC。接下来只需要将操作面板中的按钮切换到 `All` 模式，然后点击即可开始多账号托管。

方案的执行顺序为从上到下，依次执行default、planB、planC。

为了使多账号托管按预期运行，建议先运行游戏并退出当前登录的账号，进入下面的界面：

![登录界面](/img/use/login.png)

现在，您可以回到SRA的操作面板，点击 `All` 即可开始您的多账号托管之旅。
:::

## 扩展功能/插件

点击侧边栏中的 `扩展` 进入拓展标签页。
![拓展界面](/img/use/extension.png)
自动对话：开启后在进入剧情时会自动播放对话、自动选择对话选项。此功能不会控制鼠标，但是会让游戏处于前台。如果需要取消执行，尝试将游戏最小化后回到此页面取消勾选。
跳过对话：需先开启自动对话，开启后在进入剧情时会自动跳过可跳过的对话。

:::warning
下面的内容已经过时，SRA在 `2.0.0` 版本尚不支持插件功能。
:::

:::warning
插件是 `0.8.2` 版本添加的，不可用于之前的版本！
:::

点击上方扩展/插件进入标签页。

此时左上方部分为扩展功能，右上方功能是插件。

扩展功能在开启后会立即执行直到取消勾选。

自动对话：开启后在进入剧情时会自动播放对话、自动选择对话选项。此功能不会控制鼠标，但是会让游戏处于前台。如果需要取消执行，尝试将游戏最小化后回到此页面取消勾选。

插件按钮可能是用来开启功能的，也可能是展示版本信息、打开插件设置的，取决于开发者。

### 安装插件

:::warning
这些的内容已经过时，SRA在 `2.0.0` 版本尚不支持插件功能。
:::
在[插件市场](/pluginstore)中寻找插件。

一般来说，官网/插件介绍中会介绍如何进行安装。此处展示一般的安装过程。

1. 下载插件

进入插件页面，自行寻找插件下载链接。

2. 解压插件/安装插件

解压缩插件到文件夹中，确保文件夹内目录包含`__init__.py`。

将该文件夹移动到`SRA根目录\Plugins\`下。

## 设置

:::tip
下面的内容以 `2.0.0` 版本为例进行说明。
:::
点击侧边栏'设置'进入标签页。此处可更改SRA的设置。

- 任务通用设置
    - 缩放比例：自动获取，应该与系统显示设置中的缩放比例一致。
    - 识图置信度阈值：控制应用识别游戏内元素的严格程度。默认值为 0.90（90%），可在 0~1
      之间调整，每次增减0.01。值越高，识别越精准（减少误识别）；值越低，识别范围越广（可能出现误识别）。
    - 线程安全模式（已过时）：该设置目前无实际作用，应用已改用 “进程” 机制防止卡顿，无需调整。
- 显示设置
    - 背景图片透明度：调整主页背景图片的透明程度，默认值为 0.9（90% 不透明）。 拖动滑块可在 0~1 之间精细调整，值越小越透明，值越大越清晰（0
      为完全透明，1 为完全不透明）。
    - 语言切换：选择应用界面的显示语言，默认是 “简体中文”。可切换为 “English”（英文），切换后需重启应用才能生效。
- 常规设置
    - 通知管理
        - 允许通知：总开关，开启后才能接收应用的各类通知（默认开启）；关闭后所有通知都会被屏蔽。
        - 系统通知：开启后，应用会通过系统弹窗发送提醒（如更新通知、任务完成提示，默认开启）。
        - 邮件通知：开启后，应用会通过邮件发送重要信息（如异常提醒，默认关闭），需提前配置接收邮箱。
    - 开机自启动：此设置项无效，因应用需要管理员权限，无法直接设置开机自启，如需此功能可通过系统 “任务计划程序” 手动配置,
      确保 '起始于' 参数为SRA的安装目录。
    - 最小化到托盘：尚未实现，目前处于禁用状态，暂不支持 “最小化时隐藏到系统托盘” 功能，后续版本可能开放。
- 更新设置
    - 自动更新：开启后，应用会自动检测新版本并下载更新包（默认开启），下载完成后需手动安装；关闭后需手动检查并更新。
    - Mirror 酱 CDK：输入 Mirror 酱高速下载服务的授权码（CDK），解锁高速下载更新包的权限。输入时内容会以 “*” 隐藏，下方会显示
      CDK 的状态（如 “已激活”“过期”）。
    - 更新渠道：选择更新包的下载来源，默认是 “GitHub”（官方源，无需授权）；可切换为 “Mirror 酱”（高速源，需有效 CDK 才能使用）。
    - 应用渠道：选择应用的版本类型，默认是 “stable”（稳定版，bug 少，适合日常使用）；可切换为 “beta”（测试版，含最新功能，可能存在少量bug）。
- 高级设置
    - 资源完整性校验：尚未实现，目前处于禁用状态，暂不支持手动触发 “应用资源文件检查” 功能，后续版本可能开放（该功能用于检测核心文件是否损坏或被篡改）。
- 关于

:::warning
下面的内容已经过时，SRA在 `2.0.0` 版本尚未支持这些功能。
:::

![通知设置](/img/use/notification.png)

1. 允许通知：这是通知的总开关
2. 系统通知：启用此项后，当SRA发送通知时，会发送一个系统通知。
3. 邮件通知：启用此项后，当SRA发送通知时，会发送一个邮件通知。需要先配置好SMTP服务并点击验证按钮。在 `邮件通知` 会详细介绍

## 控制台

### 日志过滤器

转到控制台标签页，可以看到日志过滤器。
其中有5个日志级别的按钮，分别是：

- TRACE：跟踪级别，显示最详细的日志信息，通常用于调试
- DEBUG：调试级别，显示调试信息，帮助开发者诊断问题
- INFO：信息级别，显示一般信息，通常用于记录程序的正常运行状态
- WARNING：警告级别，显示潜在问题的警告信息
- ERROR：错误级别，显示错误信息，通常用于记录程序运行中的错误

点击对应按钮可以切换对应日志级别的显示状态。按钮亮起表示该级别日志被显示，按钮暗淡表示该级别日志被隐藏。

### 交互输入框

在控制台标签页的底部，有一个交互输入框。提示“请输入文本” ，用于接收用户的输入。
用户可以在此输入文本，并按下回车键提交输入。
提交后，输入的文本会被发送到SRA的标准输入流中，供程序读取和处理。
详细使用方法请参考 [SRAcli 的简单使用](#简单使用) 部分。

## SRAcli

在 SRA 2.0 版本中，我们提供了一个独立的命令行程序 `SRA-cli.exe`，用于在命令行中执行 SRA 任务。

![SRA-cli](/img/use/software2.png)

此应用程序是 SRA 的实际功能执行者，主程序通过嵌入式调用 SRA-cli 来完成任务。

因此，您可以直接使用 SRA-cli 来执行任务，而无需打开主程序。
:::tip 尽管如此，您仍需要先通过主程序配置好任务，SRA-cli 仅用于执行任务。
:::

### 简单使用

双击运行 `SRA-cli.exe`，即可看到 SRA-cli 的控制台窗口。
输入help查看可用命令：

```bash
sra> help
可用命令:
  EOF - Ctrl+D 退出命令行工具
  exit - 退出命令行工具
  help - 显示帮助信息
  run - 运行指定任务, 会阻塞当前命令行直到任务完成
  task - 任务管理器命令 - 支持启动/停止任务进程
  trigger - 触发器管理器命令 - 支持启动/停止/配置触发器

输入 'help <命令名>' 查看详细用法（例：help trigger）
sra> 
```

#### 运行任务

使用 `task run [配置名称...]` 命令运行任务。
如果不指定配置名称，则默认运行全部配置。
可以指定多个配置名称，SRA-cli 会依次运行这些配置。
示例：

```bash
sra> task run Default PlanB
```

上述命令会依次运行名为 `Default` 和 `PlanB` 的配置

#### 停止任务

使用 `task stop` 命令停止正在运行的所有任务。

#### 触发器管理

使用 `trigger` 命令管理触发器。
查看触发器帮助：

```bash
sra> help trigger
trigger - 触发器管理器命令 - 支持启动/停止/配置触发器
  用法：
    trigger run                - 启动 TriggerManager 线程
    trigger stop               - 停止 TriggerManager 线程
    trigger enable <名称>       - 启用指定触发器（例：trigger enable TimerTrigger）
    trigger disable <名称>      - 禁用指定触发器（例：trigger disable TimerTrigger）
    trigger set-<类型> <名> <属性> <值> - 设置属性（支持类型：int/float/str/bool）
      示例：
        trigger set-int  TimerTrigger interval 30    # 整数类型
        trigger set-bool TimerTrigger enable true     # 布尔类型
        trigger set-str  LogTrigger path /var/log     # 字符串类型
  说明：
    - 触发器名称不区分大小写（例：TimerTrigger 和 timetrigger 等效）
    - 布尔值支持：true/1/yes（真）、false/0/no（假）
sra> 
```

自动对话是一个触发器，可以通过以下命令启用：

```bash
sra> trigger run
sra> trigger enable AutoDialogueTrigger
```

自动对话具有skip_plot属性，可以通过以下命令启用跳过对话功能：

```bash
sra> trigger set-bool AutoDialogueTrigger skip_plot true
```

### 高级使用

SRA-cli 支持通过命令行参数调用。
使用`sra-cli --help`查看帮助信息：

```bash
usage: main.py [-h] [--inline] [--embed] {run} ...

SRA 命令行工具

options:
  -h, --help  show this help message and exit
  --inline    内嵌模式（无命令提示符，适用于被其他程序调用）
  --embed     同 --inline

commands:
  {run}
    run       单次执行任务（如 "run Default"）

examples：
  交互模式：SRA-cli
  单次执行：SRA-cli run [配置名称...] --once
  内嵌模式：SRA-cli --inline
```

#### 通过命令行参数运行任务

输入 `SRA-cli run -h` 查看 `run` 命令的帮助信息：

```bash
usage: main.py run [-h] [-c [CONFIG ...]] [--once]

执行完任务后默认进入交互模式，可配合 --once 立即退出

options:
  -h, --help            show this help message and exit
  --config [CONFIG ...] 要运行的配置名称, 不指定则运行缓存中的全部配置
  --once                执行完任务后退出
```

使用 `SRA-cli run --config [配置名称...]` 命令运行任务。
如果不指定配置名称，则默认运行全部配置。
可以指定多个配置名称，SRA-cli 会依次运行这些配置。
使用此命令运行任务后，当前命令行会被阻塞，直到任务完成。可通过按下 `Ctrl+C` 停止任务。
使用此命令运行任务后，SRA-cli 会在任务完成后返回交互模式。如果需要仅执行任务后退出，可以添加 `--once` 参数。
示例：

```bash
SRA-cli run --config Default PlanB --once
```

上述命令会依次运行名为 `Default` 和 `PlanB` 的配置，任务完成后退出 SRA-cli。

#### 将SRA与第三方程序集成

:::tip SRA运行需要管理员权限
:::
SRA已准备好与第三方程序集成，方便其他程序调用SRA来执行任务，例如 `AUTO-MAS` (原 `AUTO-MAA`)。

SRA-cli 支持内嵌模式，可通过 `--inline` 或 `--embed` 参数启用。
启用内嵌模式后，SRA-cli 将会关闭prompt，专注于打印日志，非常适合被其他程序调用。
示例：

```bash
SRA-cli --inline
```

此命令会启动 SRA-cli 并进入内嵌模式，等待其他程序通过标准输入发送命令。

确保SRA-cli的工作目录为安装目录，否则可能无法正确加载任务类。

SRA的运行日志存放在 `SRA根目录/log/` 下，按日期分割，第三方程序可以日志文件来获取运行状态。

当开始运行任务时，SRA-cli会打印级别为 `DEBUG`, 含有 `[Start]` 信息的日志，便于第三方程序检测任务开始。

当任务结束时，SRA-cli会打印级别为 `DEBUG`, 含有 `[Done]` 信息的日志，便于第三方程序检测任务结束。

当使用 `task stop` 命令停止任务时，SRA-cli会额外打印含有 `[Abort]` 信息的日志，便于第三方程序检测任务被停止。

与先前的命令结合，可以轻松启动SRA并运行一次性任务：

```bash
SRA-cli --inline run --config Default PlanB --once
```

## 更新

:::warning
这部分内容已经过时，在SRA 2.0.0 版本中更新器已集成到主程序。
:::
SRA所有的下载及更新服务都集成于 **SRA更新器（SRAUpdater）**，如果您缺失了这个文件，前往下载页面来下载它。

双击运行更新器，更新器就会进行一次正常更新流程。在下载时，可以通过Ctrl+C取消下载。

更新器也支持使用命令行参数启动，下面是一些参数解释：

1. `-h` ：用于查看帮助信息
2. `-u URL` ：指定下载文件链接。SRA更新器不仅能用来更新SRA，还能借助它下载其他任何文件，只需将URL替换为需要下载的文件链接。
3. `-p PROXY` ：指定下载代理。如果您有自己的代理网站，可以使用此参数来设置它，只需将PROXY替换为您的代理网站。
4. `-np` ：禁用代理。np代指 `no proxy` 。如果您要下载的文件不需要经过代理，或者要使用加速器下载，可以通过使用此参数来关闭代理。
5. `-nv` ：禁用SSL证书验证。当使用加速器下载时，除了需要使用上面的-np参数，还有可能遇到SSL证书验证失败，此时使用此参数关闭SSL证书认证来完成下载。
6. `-f` ：强制更新。由于种种原因导致您的SRA处于旧版而启动器处于新版从而导致version文件不兼容，此时可使用此参数进行强制更新，即
   *无论是否是最新版本都强制更新为最新版本*
7. `-i` ：进行文件完整性检查。此参数会检测SRA的所有文件是否存在。如果不存在或版本不正确则重新下载。
8. `-vb` ：显示完整的日志信息。通常与其他参数混合使用，输出更完整的日志。
9. `-v` ：显示更新器当前版本信息。
10. `-timeout` ：设置请求超时的最长时间。

## 邮件通知

:::warning
2.0.0 中过时的内容。
:::
在 `0.8.1` 版本中引入了邮件通知功能。

在设置中，勾选 `邮件通知` ，并在下方配置 SMTP 服务并点击验证。

SMTP是一种可靠有效的电子邮件传输协议，SRA 使用SMTP-SSL推送电子邮件通知。

### SMTP 服务器地址

根据发信邮箱的电子邮件服务提供商选择正确的 SMTP 服务器地址。

| 电子邮件服务提供商       | SMTP服务器地址             |
|-----------------|-----------------------|
| QQ邮箱            | smtp.qq.com           |
| 163邮箱           | smtp.163.com          |
| Gmail           | smtp.gmail.com        |
| Outlook/Hotmail | smtp-mail.outlook.com |
| Yahoo Mail      | smtp.mail.yahoo.com   |

上方列举了部分邮件提供商以及对应的SMTP服务器地址。如果您没在上表中找到您的邮件提供商，请自行查找、咨询。

### 授权码

**授权码**是用于替代您的邮箱密码进行第三方客户端登录的一种特殊密码，您需要填写发信邮箱的授权码。

下面列举了部分提供商授权码的获取步骤：

- [QQ邮箱](https://service.mail.qq.com/detail/0/75)
    - 登录您的邮箱，然后进入[QQ邮箱账号与安全中心](https://wx.mail.qq.com/account)
    - 在 `账号与安全` -> `安全设置` -> `SMTP/IMAP服务` 中开启服务并获取授权码

- [163邮箱](https://help.mail.163.com/faqDetail.do?code=d7a5dc8471cd0c0e8b4b8f4f8e49998b374173cfe9171305fa1ce630d7f67ac2a5feb28b66796d3b)
    - 登录您的邮箱，然后进入 `设置` -> `POP3/SMTP/IMAP` ，找到 `IMAP/SMTP服务` 并点击开启
    - 在弹窗中按照提示操作，然后弹窗生成授权密码，该密码即授权码。

- **Gmail**
    - 登录您的邮箱，然后进入[安全性](https://myaccount.google.com/security?) -> `您的Google账号登录选项` -> `两步验证`
      ，按照说明启动两步验证。
    - 打开[应用专用密码](https://myaccount.google.com/apppasswords)，按照提示操作即可获取专用密码，该密码即授权码。

:::tip
自 2025 年 1 月起，"启用 IMAP"和"停用 IMAP"选项将无法再使用。Gmail 中的 IMAP
访问功能始终处于启用状态，您当前与其他电子邮件客户端的连接不会受到影响。您无需采取任何行动。
:::

- **Outlook/Hotmail**
    - 登录 `Mircosoft账号` ，然后进入[其他安全选项](https://go.microsoft.com/fwlink/?linkid=2274139) -> `双重验证`
      ，按照说明打开双重验证。
    - 打开双重验证后，向下滑找到 `应用密码` ，点击 `创建新应用密码`

- [Yahoo Mail](https://help.yahoo.com/kb/generate-third-party-passwords-sln15241.html)
    - 登录到[Yahoo账号安全](https://login.yahoo.com/account/security?.lang=en-US&.intl=us&.src=yhelp)
    - 点击 `Generate app password` 或 `Generate and manage app passwords` -> `Get Started` -> 在文本字段中输入您的应用名称
    - 点击 `Generate password` ，此密码即授权码。

:::warning
为了您的信息安全，请勿将授权码告诉他人，并定期更换。

部分邮箱的授权码仅显示一次，请及时保存；部分邮箱的授权码存在有效期，请在到期前及时更换。

SRA 已对本地授权码数据使用 `Windows DPAPI`
加密，这种加密方式将当前用户的登录凭据作为加密密钥的一部分，这意味着只有同一个用户在同一台计算机上才能解密数据。如果您需要跨设备迁移配置文件，请重新输入授权码。

**SMTP**邮件推送服务允许发信邮箱与收信邮箱相同，若没有多余的电子邮箱，可以填写相同的发信邮箱与收信邮箱地址。
:::

## 调试模式

:::warning
要求 SRA版本 < `2.0`。
:::
调试模式可以通过在命令行运行SRA来启动。

具体步骤如下：

1. 打开SRA所在文件夹
2. 在**文件夹内空白处**右键 -> 在终端中打开（仅限Windows 11或安装了Windows Terminal应用程序的Windows 10）或点击 `文件资源管理器`
   上方的地址栏，在可编辑状态下写 `cmd` 或 `powershell` 打开命令行。
3. 输入`SRA.exe`（cmd）或`.\SRA.exe`（powershell），此时SRA将以调试模式启动，您可以在命令行程序看到包括 `DEBUG` 级别和 `TRACE`
   级别的所有信息。
4. 如果此时关闭命令行窗口，SRA也将一同被关闭。

::: tip 在终端窗口中直接输入`cmd`或`powershell`可以在`命令提示符`和`Windows PowerShell` 之间互相切换
:::

## 命令行模式

:::tip
要求  `0.8.2` <= SRA版本 < `1.0`。
:::

在 `0.8.2+` 版本中SRA提供了命令行模式。

如果您有使用命令行的需求，可以使用该模式。

使用步骤：

1. 仿照调试模式->具体步骤打开命令行，然后输入：

::: tabs

@tab cmd

```bash
powershell -command "Start-Process cmd -Verb runAs -ArgumentList '/K', 'cd /d \"%CD%\"'"
```

@tab powershell

```bash
Start-Process powershell -Verb runAs -ArgumentList "-NoExit", "-Command", "cd '$((Get-Location).Path)'"
```

:::

:::warning

在某些情况下，这个命令可能无法使用。此时只能使用 `cd` 命令像双击打开文件那样打开文件目录。

不过，您可以复制地址栏，然后粘贴在 `cd` 的后面。

:::

2. 在新窗口中输入 `SRA.exe --cli` （cmd）或 `.\SRA.exe --cli` （powershell）。此时，您已经成功启用命令行了！

:::warning

在使用之前，我们建议先输入exit退出一遍SRA命令行再重新进入。

这是打包后的显示错误，截止到目前（文档编辑最后时间）尚未解决。

:::
进入命令行后，您将看到如下信息：

```bash
SRA v0.8.2 for Windows
欢迎使用 SRA 命令行模式！输入 help 或 ? 查看帮助信息。
SRA>
```

现在，您可以享用命令行模式了。输入 `?` 或 `help` 来获取帮助。

```bash
SRA>? 
可用命令：
  config - 显示指定配置
  echo - 回显输入的内容
  exit - 退出命令行程序
  globals - 显示全局配置
  help - 显示帮助信息
  run - 运行指定配置的任务
  version - 显示当前SRA版本
```

目前 SRA 命令行仅可查看配置文件而不可修改。如果要进行配置操作，请使用GUI。

输入 `run` 可以以指定的配置运行，如果不指定配置，将默认使用 Default (`config` 命令同理)。

例如: `run Default other...`

:::warning 该命令会线程阻塞，您无法在任务结束前执行其它命令。如果您想要停止任务，请在命令行使用 `Ctrl` + `C` 来终止。
:::

:::info
**另一种方式：**

如果您使用SRA命令行只是为了执行任务，或者您只想直接执行任务不使用SRA命令行，可以在窗口中输入`SRA --run [config] [...]`
直接开始执行任务。
:::


